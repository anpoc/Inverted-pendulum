\documentclass{ieeeaccess}
\usepackage{cite}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{multirow}
\usepackage{listings}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}
\history{Date of current version 23 02, 2018.}
\doi{10.1109/ACCESS.2017.DOI}

\title{PÉNDULO INVERTIDO}
\author{\uppercase{Andrea Posada Cárdenas\authorrefmark{1}},
  \uppercase{Santiago Hincapie Potes}\authorrefmark{2}}
\address[1]{Estudiante de Ingeniería Matemática, Universidad EAFIT,
  Medellin, Colombia (e-mail: aposad31@eafit.edu.co)}
\address[2]{Estudiante de Ingeniería Matemática, Universidad EAFIT,
  Medellin, Colombia (e-mail: shinca12@eafit.edu.co)}

\markboth{}
{Author \headeretal: Preparation of Papers for IEEE TRANSACTIONS and JOURNALS}

\corresp{Corresponding author: Andrea Posada Cárdenas
  (e-mail: aposad31@eafit.edu.co).}

\begin{abstract}
  El péndulo invertido es representa un sistema no lineal, típico en la literatura debido a que es inestable sin control en su punto de interés. Se realiza en análisis lineal sobre el punto de equilibrio estable $X_0=0$ y $U_0=0$. El rango de linealidad se estima como $[-2.5,2.5]$. Se presentan los resultados de simulación a variaciones en la entrada y en condiciones iniciales para $\theta$.
\end{abstract}

\begin{keywords}
  Péndulo invertido, Simulink, Simulación, Sistema dinámico no lineal.
\end{keywords}

\titlepgskip=-15pt

\maketitle

\section{Introducción}\label{sec:introduction}

El péndulo invertido sobre un carro representa un sistema que comúnmente es encontrado en los libros de control y en la literatura. Esto se debe en parte a que es inestable sin control, e.d., el péndulo caería si el carro no se moviese para balancearlo y a que es un sistema no lineal. El despegue de cohetes está relacionado directamente con el sistema del péndulo invertido \cite{pag}.\\

Se estudia el péndulo invertido en dos dimensiones, mostrado en la Figura ~\ref{diagram}. La entrada de control es la fuerza $F$ que mueve el carro horizontalmente y las salidas son la posición angular del péndulo $\theta$ y la posición horizontal del carro $x$, siendo un sistema `single input, multiple output' SIMO.\@ Las entradas, salidas y parámetros, su notación, significado físico y unidades de medida se presentan en el Cuadro~\ref{tab: des} \cite{pag}.

\begin{table}[ht!]
\centering
\caption{Parámetros, entradas y salidas\label{tab: des}}
\begin{tabular}{|c|ll|c|}
\hline
\multicolumn{1}{|l|}{\textbf{}} & \multicolumn{1}{l|}{\textbf{Notación}} &
\multicolumn{1}{c|}{\textbf{Significado}} &
\multicolumn{1}{c|}{\textbf{Unidades}} \\ \hline
\multirow{7}{*}{\rotatebox{90}{\textbf{Parámetros}}} &
\multicolumn{1}{c|}{$M$}   & masa del carro                            & kg   \\
& \multicolumn{1}{c|}{$m$} & masa del péndulo                          & kg   \\
& \multicolumn{1}{c|}{$b$} & coeficiente de fricción                  & N*m/s \\
& \multicolumn{1}{c|}{$I$} & momento de inercia del centro de masa     & kg   \\
& \multicolumn{1}{c|}{}    & del péndulo                               &      \\
& \multicolumn{1}{c|}{$L$} & longitud al centro de masa del péndulo    & m    \\
& \multicolumn{1}{c|}{$g$} & gravedad                               & $m/s^2$ \\
\hline
\multirow{3}{*}{\rotatebox{90}{\textbf{Inputs}}} & \multicolumn{1}{c|}{} & &  \\
& \multicolumn{1}{c|}{$F$}  & fuerza aplicada al carro                   & N  \\
& \multicolumn{1}{c|}{}     &                                            &    \\
\hline
\multirow{4}{*}{\rotatebox{90}{\textbf{Outputs}}} & \multicolumn{1}{c|}{} & & \\
& \multicolumn{1}{c|}{$x$} & posición del carro en el eje x               & m \\
& \multicolumn{1}{c|}{$\theta$} & ángulo del péndulo desde la vertical (abajo)
      & rad \\ & \multicolumn{1}{c|}{}                                    & & \\
\hline
\end{tabular}
\end{table}

\Figure[ht!][scale=0.5]{pendulo.PNG}{Representación gráfica del péndulo invertido.\label{diagram}}

\subsection{Análisis diagrama de cuerpo libre y sistema de ecuaciones}

El diagrama de cuerpo libre se presenta en la Figura~\ref{cuerpo}.\\

\Figure[t!][scale=0.5]{diagrama_cuerpo.PNG}{Diagrama de cuerpo libre del péndulo invertido.\label{cuerpo}}

Sumando las fuerzas horizontales se obtiene la siguiente ecuación de movimiento
\begin{equation}
\label{eq:motion}
M\ddot{x}+b\dot{x}+N = F
\end{equation}
donde
\[N = m\ddot{x} + ml\ddot{\theta}\cos(\theta) - ml{\dot(\theta)}^2\sin(\theta)\]
generada de la suma de las fuerzas horizontales en el diagrama de cuerpo libre del péndulo.\\

Sustituyendo $N$ en la ecuación (1), se obtiene
\begin{equation}
  \label{eq:motion1}
  (M + m)\ddot{x} + b\dot{x} + ml\ddot{\theta}\cos(\theta)
     - ml\dot{\theta}^2\sin(\theta) = F
\end{equation}
\\
Por otro lado, sumando las fuerzas verticales en el diagrama diagrama de cuerpo libre del péndulo y los momentos alrededor del centroide del péndulo, se obtiene, respectivamente
\[P\sin(\theta) + N\cos(\theta) - mg\sin(\theta)
   = ml\ddot{\theta} + m\ddot{x}\cos(\theta)\]
\[Pl\sin(\theta) - Nl\cos(\theta) = I\ddot{\theta}\]
\\
Remplazando la ecuación de la suma de los momentos en la de la suma de las fuerzas verticales (ecuaciones anteriores), da como resultado
\begin{equation}
\label{eq:motion2}
(I + ml^2)\ddot{\theta} + mgl\sin(\theta) = -ml\ddot{x}\cos(\theta)
\end{equation}

Las ecuaciones (\ref{eq:motion1}) y (\ref{eq:motion2}) son las ecuaciones que describen el sistema.

\section{Sistema no lineal}

\subsection{Variables}\label{subsub:var}

\begin{flalign*}
\raggedright
  x_1 &= x       & \text{posición del carro}                   \\
  x_2 &= \dot{x} & \text{velocidad del carro}                  \\
  x_3 &= \theta       & \text{ángulo del péndulo desde la vertical} \\
  x_4 &= \dot{\theta} & \text{velocidad angular del péndulo}        \\
  u   &= F       & \text{Fuerza de entrada}
\end{flalign*}

\subsection{Espacio de estados no lineal}

Partiendo de las ecuaciones de movimiento (\ref{eq:motion1}) y
(\ref{eq:motion2}) y teniendo en cuenta la notación introducida anteriormente en
~\ref{subsub:var}, se redefine el sistema de ecuaciones de la siguiente
manera.

\begin{eqnarray}
  \label{eq:sistema}
  \left\{
  \begin{array}{ll}
    f_1 = \displaystyle\dot{x_1} = \displaystyle x_2 \\
    f_2 = \displaystyle\dot{x_2} =
            \displaystyle\frac{(I + ml^2)a + m^2l^2g\sin(x_3)\cos(x_3)}
              {(M + m)(I + ml^2)-m^2l^2\cos^2(x_3)}\\
    f_3 = \displaystyle\dot{x_3} = \displaystyle x_4\\
    f_4 = \dot{x_4} = \displaystyle\frac{-ml\cos(x_3)a - (M + m)mlg\sin(x_3)}
                         {(M + m)(I + ml^2) - m^2l^2\cos^2(x_3)}\\
  \end{array}
  \right.
\end{eqnarray}
donde $a = u-bx_2+mlx_4^2\sin(x_3)$\\

$\dot{x_2}$ y $\dot{x_4}$ se obtienen despejando $\ddot{x}$ y $\ddot{\theta}$ de
las ecuaciones (\ref{eq:motion1}) y (\ref{eq:motion2}), como se muestra a
continuación, y teniendo en cuenta que $\ddot{x}=\dot{x_2}$ y
$\ddot{\theta}=\dot{x_4}$

\begin{eqnarray}
  \label{eq: x_2}
  \dot{x_2} = \displaystyle\frac{u - bx_2 - ml\dot{x_4}\cos(x_3)
    + mlx_4^2\sin(x_3)}{M+m}\\
  \label{eq: x_4}
  \dot{x_4} = \displaystyle\frac{-ml\dot{x_2}\cos(x_3) - mlg\sin(x_3)}{I + ml^2}
\end{eqnarray}\\

Al reemplazar el valor de $\dot{x_4}$, ecuación (\ref{eq: x_4}), en la ecuación
(\ref{eq: x_2}), hacer álgebra y juntar términos semejantes se obtiene la
expresión del sistema de ecuaciones (\ref{eq:sistema}) para $\dot{x_2}$.
Repitiendo el mismo proceso pero para el valor de $\dot{x_2}$, ecuación
(\ref{eq: x_2}), en la ecuación (\ref{eq: x_4}) se obtiene la expresión
señalada en el sistema de ecuaciones (\ref{eq:sistema}) para $\dot{x_4}$

\subsection{Salidas}

El sistema de ecuaciones (\ref{eq: salidas}) es la representación de las salidas
del sistema.
\begin{eqnarray}
  \label{eq: salidas}
  \left\{
  \begin{array}{ll}
    h_1=x_1\\
    h_2=x_3\\
  \end{array}
  \right.
\end{eqnarray}

\subsection{Diagrama de bloques de \textit{Simulink --- MATLAB}}

El péndulo invertido sobre un carro se implementó en \textit{Simulink} de
\textit{MATLAB}. Se presentan el diagrama de bloques,~\ref{diagramabloques},
la expansión del subsistema,\ref{subsistema}, y el código de \textit{MATLAB} de
la fcn, que es simplemente la implementación del sistema de ecuaciones
(\ref{eq:sistema}). Los párametros no aparecen con los valores empleados,
dado que la asignación de estos, al igual que la de las condiciones iniciales
se realiza mediante una máscara.


\Figure[ht!][scale=1]{diagrama_bloques.PNG}
{diagrama de bloques.\label{diagramabloques}}

\Figure[ht!][scale=0.6]{diagrama_bloques_subsistema.PNG}
{diagrama de bloques subsistema.\label{subsistema}}

\lstset{language=Matlab, breaklines=true, basicstyle=\footnotesize}
\lstset{numbers=left, numberstyle=\tiny, stepnumber=1, numbersep=-2pt}
\begin{lstlisting}[frame=single]
function [dx1, dx2, dx3, dx4] = fcn(M, m, b, L, I, g, u, x1, x2, x3, x4)
    denominator = (M+m)*(I+m*L^2)-m^2*L^2*cos(x3)^2;
    dx1 = x2;
    dx2 = ((I+m*L^2)*(u-b*x2+m*L*x4^2*sin(x3))+m^2*L^2*g*sin(x3)*cos(x3))/denominator;
    dx3 = x4;
    dx4 = (-m*L*u*cos(x3)+m*L*b*x2*cos(x3)-m^2*L^2*x4^2*sin(x3)*cos(x3)-(M+m)*m*g*L*sin(x3))/denominator;
end
\end{lstlisting}

\section{Simulación}

Las simulaciones realizadas en esta y en las secciones posteriores se realizan con los siguientes valores para los parámetros, a menos de que se indique lo contrario: $M=0.5$, $m=0.2$, $b=0.1$, $L=0.3$, $I=0.006$ y $g=9.8$ con unidades indicadas en el Cuadro \ref{tab: des}.

\input{diff.tex}
\subsection{Solución numérica}
\subsubsection{Método de Euler}
En la Figura~\ref{fig:nmth} se puede ver la comparación del resultado
obtenido al realizar la simulación con el método de Euler, con un
paso $h = \frac{1}{4000}$, porque con valores mas altos
la diferencia entre ambas simulaciones se vuelve bastante notoria.
Estas diferencias pueden deberse a la alta complejidad de las
ecuaciones de estado, por lo cual se vuelve necesario utilizar un
paso bastante pequeño, a pesar de esto, es fácil ver que aún con
un paso diminuto no se consigue una buena aproximación del sistema.
\subsubsection{Método de Runge-Kutta}
Para el método de Runge-Kutta de cuarto orden, el paso utilizado fue
de $h = \frac{1}{10}$, la precisión obtenida es tal que en la figura
no se logra observar fácilmente la simulación arrojada por \textit{Simulink}.
Esto indica que el método de Runge-Kutta posee un orden de error
bastante bajo, por lo cual se puede decir que realiza buenas
aproximaciones de las ecuaciones de estados.\\
Es importante resaltar que al utilizar un paso relativamente grande,
el tiempo de computo asociado al método es bastante bajo.

\subsection{Cambio de parámetros}
Para analizar la sensibilidad del modelo a ciertos parámetros, se
consideró el efecto del cambio sobre dos parámetros del modelo,
la longitud al centro de masa del péndulo y la masa del péndulo,
esto debido a que experimentalmente hablando es bastante sencillo y
económico remplazar esta componentes del péndulo.
\subsubsection{Longitud al centro de masa}
En la Figura~\ref{fig:var-len} se varía la distancia del centro de masa
del péndulo. De la gráfica se observa que la amplitud con la que se
mueve el carro disminuye a medida que disminuye la distancia del centro
de masa del péndulo, esto se debe a que la inercia depende de esta
distancia y es esta la que provoca dichos movimientos sobre el carro.
Por otro lado, es posible notar que el ángulo del péndulo
no se ve muy afectado por esta longitud.
\subsubsection{Masa del péndulo}
En la Figura~\ref{fig:var-mass} se puede observar la respuesta temporal
al variar la masa del péndulo, de la cual se puede observar que la amplitud
del ángulo disminuye a medida que aumenta la masa del péndulo. Por otro
lado, la frecuencia con la que éste oscila aumenta, lo cual tiene sentido
pues el péndulo se mueve más rápido sobre ángulos más pequeños; lo que se
corrobora al ver la gráfica de la posición, la cual no solo aumenta más
rápido, sino que lo hace con una mayor concavidad, indicando que la
aceleración del péndulo es mayor, haciendo que la fuerza requerida
sea mayor, lo cual tiene sentido pues se requiere mover más masa.


\section{Linealización}
\subsection{Puntos de equilibrio}
Igualando las $f_n$ a 0, para $n=1,2,3,4$, se obtienen seis puntos de
equilibrio, mostrados en el Cuadro~\ref{tab: ptoseq}.


\begin{table}[ht!]
  \centering
  \caption{Puntos de equilibrio}\label{tab: ptoseq}
  \begin{tabular}{|c|c|c|}
    \hline
    \textbf{} & \textbf{Variable} & \textbf{Valor}\\
    \hline
    \multirow{5}{*}{\textbf{1}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & $- \pi + 2\arctan((33^{1/2}\cdot n)/11 - (154^{1/2}\cdot n)/11)$\\
    & $x_4$ & 0\\
    & $u$ & $(154^{1/2}\cdot 49i)/100$\\
    \hline
    \multirow{5}{*}{\textbf{2}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & $-2\cdot\arctan((33^{1/2}\cdot n)/11 - (154^{1/2}\cdot n)/11)$\\
    & $x_4$ & 0\\
    & $u$ & $-(154^{1/2}\cdot 49n)/100$\\
    \hline
    \multirow{5}{*}{\textbf{3}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & $2\cdot\arctan((33^{1/2}\cdot n)/11 - (154^{1/2}\cdot n)/11)$\\
    & $x_4$ & 0\\
    & $u$ & $(154^{1/2}\cdot 49n)/100$\\
    \hline
    \multirow{5}{*}{\textbf{4}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & $\pi$\\
    & $x_4$ & 0\\
    & $u$ & 0\\
    \hline
    \multirow{5}{*}{\textbf{4}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & 0\\
    & $x_4$ & 0\\
    & $u$ & 0\\
    \hline
    \multirow{5}{*}{\textbf{4}} & $x_1$ & 0\\
    & $x_2$ & 0\\
    & $x_3$ & $\pi - 2\cdot\arctan((33^{1/2}\cdot n)/11
              - (154^{1/2}\cdot n)/11)$\\
    & $x_4$ & 0\\
    & $u$ & $-(154^{1/2}\cdot 49n)/100$\\
    \hline
\end{tabular}
\end{table}

\subsection{Sistema linealizado}
Un sistema lineal es de la forma
\[\dot{X}=AX+BU\]
\[Y=CX+DU\]
donde $Y$ es el vector de salidas, $X$ es el vector de estados, $U$ es el vector
de entradas y $A$, $B$, $C$ y $D$ son matrices (o vectores dependiendo de las
dimensiones de $X$ y $U$) de coeficientes constantes.\\

Tanto la linealización analítica como la linealización realizada con
\textit{MATLAB}, utilizando el modelo de bloques de \textit{Simulink},
se hacen con respecto al punto de equilibrio $x_1=0$, $x_2=0$, $x_3=0$, $x_4=0$ y $u=0$.

\subsubsection{Linealización analítica}
La linealización analítica del sistema se realiza por medio de aproximación por series de Taylor, como se muestra a continuación, con punto de evaluación $X_0, U_0$ el indicado anteriormente.
\[\begin{split}
f_i(X, U) \approx f_i(X_0, U_0) + \sum_{j=1}^{4}\frac{\partial f_i(X, U)}{\partial x_j}\bigg\rvert_{X=X_0, U=U_0}\Delta x_j \\
+\frac{\partial f_i(X, U)}{\partial U}\bigg\rvert_{X=X_0, U=U_0}\Delta U
\end{split}\]
\[\begin{split}
h_k(X, U) \approx h_k(X_0, U_0) + \sum_{j=1}^{4}\frac{\partial h_k(X, U)}{\partial x_j}\bigg\rvert_{X=X_0, U=U_0}\Delta x_j\\
+ \frac{\partial h_k(X, U)}{\partial U}\bigg\rvert_{X=X_0, U=U_0}\Delta U
\end{split}\]
donde $i=1,...,4$ y $k=1,2$.\\

Se sabe que las funciones en evaluadas en el punto de equilibrio, es decir, $f_i(X_0, U_0)$ y $h_k(X_0, U_0)$, tienden a cero. La representación matricial de la aproximación por series de Taylor se muestran a continuación.
\begin{eqnarray}
\Delta\dot{X} = A\Delta X + B\Delta U\\
\Delta Y = C\Delta X + D\Delta U
\end{eqnarray}
donde
\[A =\begin{bmatrix}
    0 & 1 & 0 & 0\\
    0 & -2/11 & 147/55 & 0\\
    0 & 0 & 0 & 1\\
    0 & 5/11 & -343/11 & 0
\end{bmatrix}
\]
\[B = \begin{bmatrix}
    0 &
    20/11 &
    0 &
    -50/11
\end{bmatrix}^{T}\]
\[C = \begin{bmatrix}
    1 & 0 & 0 & 0\\
    0 & 0 & 1 & 0
\end{bmatrix}\]
\[D = \begin{bmatrix}
    0&
    0
\end{bmatrix}^{T}\]

\subsubsection{Linealización con \textit{Simulink}}
Con base en el modelo de bloques mostrado en la Figura \ref{diagramabloques} y utilizando la función \textit{linmod} de MATLAB, se obtiene la siguiente linealización del modelo.

\[A =\begin{bmatrix}
    0 & 0 & 1 & 0\\
    0 & 0 & 0 & 1\\
    0 & 2.6727 & -0.1818 & 0\\
    0 & -31.1818 & 0.4545 & 0
\end{bmatrix}
\]
\[B = \begin{bmatrix}
    0 &
    0 &
    1.8182 &
    -4.5455
\end{bmatrix}^{T}\]
\[C = \begin{bmatrix}
    1 & 0 & 0 & 0\\
    0 & 1 & 0 & 0
\end{bmatrix}\]
\[D = \begin{bmatrix}
    0&
    0
\end{bmatrix}^{T}\]

Se observa que las posiciones de las variables $x_2$ y $x_3$ se encuentran trocadas. Al hacer la respectiva transformación lineal, usando la matriz $T$ definida en la parte inferior, se puede evidenciar que la linealización analítica y la linealización utilizando \textit{Simulink} son equivalentes. 
\[T=\begin{bmatrix}
1 & 0 & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 1 & 0 & 0\\
0 & 0 & 0 & 1
\end{bmatrix}\], 

\subsection{Estabilidad del punto de equilibrio $X_0=0$, $U_0=0$}
La estabilidad del punto de equilibrio se realiza por medio del cálculo de los valores propios de la matriz $A$ del sistema linealizado. Con base en dichos valores, que se muestran en el Cuadro \ref{valores propios}, y dado que todos son negativos o cero, el punto de equilibrio estudiado es estable.
\begin{table}
\centering
\label{valores propios}
\caption{Valores propios de la matriz A}
\begin{tabular}{ccl}
$\lambda_1$ & = & $0.0000 + 0.0000i$\\
$\lambda_2$ & = & $-0.1429 + 0.0000i$\\
$\lambda_2$ & = & $-0.0195 + 5.5835i$\\
$\lambda_2$ & = & $-0.0195 - 5.5835i$\\
\end{tabular}
\end{table}

\subsection{Curva de linealidad para la variable $x_3$}
La curva de linealidad obtenida enviando entradas $u \in [-5,5]$ al modelo lineal y al no lineal se muestra en la Figura \ref{fig:curve}. La curva azul hace referencia a los resultados del modelo no lineal, mientras la naranja al modelo lineal. Para entradas $u \in [-2.5, 2.5]$ se considera que el modelo lineal representa una buena aproximación del modelo no lineal.
\Figure[t!][scale=0.2]{curva_lin.png}
       {Curva de linealidad para la variable $x_3$ con entradas $u \in [-5,5]$ con tiempo de corrida 300s.\label{fig:curve}}
       
\subsubsection{Curva de linealidad con \textit{Step}}
Otra forma de hallar la curva de linealidad es por medio de una señal escalera. Para una escalera con vector de amplitud $[-5.0, -4.9,...,4.9,5]$ y paso cada 5000s, teniendo un tiempo total de simulación de 500000s, se genera la curva de linealidad mostrada en la Figura \ref{fig:curve_s}. Nuevamente, la curva azul hace referencia a los resultados del modelo no lineal, mientras la naranja al modelo lineal.

\Figure[t!][scale=0.2]{curva_lin_esc.png}
       {Curva de linealidad para la variable $x_3$ con señal escalera y tiempo de corrida 500000s.\label{fig:curve_s}}
       
Se observa similitud entre ambas curvas de linealidad, pero claramente la obtenida mediante la señal escalera no logra ser una aproximación lo suficientemente buena. Esto se puede deber principalmente a que el sistema no se alcanza a estabilizar antes de que la entrada le mande la siguiente señal y a que se trata de hacer la aproximación a una señal continua a partir de un conjunto de puntos discreto y el tamaño del conjunto de puntos puede no ser el adecuado; es decir, la distancia entre los puntos puede ser relativamente grande. Esto último se verifica viendo que la curva azul no es suave.

\section{Variación de entradas y condiciones iniciales: Modelo lineas vs. modelo no lineal}
Para todas las gráficas que se presentan a continuación, la curva azul está asociada al modelo no lineal y la naranja al no lineal.

\subsection{Variación de entrada dentro del rango de linealidad}
Se sabe que el rango de linealidad, es decir, aquel rango en el que el modelo lineal es robusto y es una buena aproximación del modelo no lineal alrededor del punto de equilibrio $X_0=0, U_0=0$, es $[-2.5,2.5]$. Por ende, se eligen dos valores en este rango $u = 0.5$ y $u = -2.0$ y se muestran las gráficas obtenidas para $x_3$ respectivamente, Figuras  $\ref{fig:u0.5}$ y $\ref{fig:u-2}$. Ambas figuras muestran la contraposición de las respuestas temporales para $x_3$ del modelo lineal y no lineal. Mas dado que esta diferencia no se observa con claridad, se añade a las gráficas la diferencia entre las respuestas temporales, representado por la curva amarilla. En ambas está diferencia es muy pequeña, próxima a cero, y con mayores valores al inicio de la simulación. Se cumple que el rango de linealidad supuesto genera resultados esperados, con lo que se concluye que el rango puede ser apropiado.  

\Figure[ht!][scale=0.2]{Graficaslvsnl/u0_5.png}
       {Respuesta temporal variable $x_3$ para entrada $u=0.5$\label{fig:u0.5}}

\Figure[ht!][scale=0.2]{Graficaslvsnl/u-2.png}
       {Respuesta temporal variable $x_3$ para entrada $u=-2.0$\label{fig:u-2}}
       
\subsection{Variación de entrada fuera del rango de linealidad}
Como se dijo anteriormente, el rango de linealidad elegido es $[-2.5,2.5]$. Se escogen los valores $u=6$ y $u=-100$, por fuera del rango mencionado. En $u=-100$, Figura \ref{fig:u-100}, se observa que el modelo lineal no es una aproximación válida para el modelo no lineal. Por otro lado, para $u=6$, la diferencia en la respuesta temporal obtenida por el modelo lineal y el no lineal no es tan clara como para $u=-100$, a pesar de que se alcanza a ver zonas azules denotando diferencia entre las curvas. Dado lo mencionado anteriormente, se añade la gráfica de contraposición de las respuestas con la diferencia entre ellas, Figura \ref{fig:u6dif}. Esta diferencia no es relativamente grande, con máximo valor absoluto alrededor de 1. Según el valor de relajamiento que se permita en la diferencia entre las respuestas temporales producidas por el modelo lineal y por el no lineal, se puede considerar ampliar el rango de linealidad propuesto.

\Figure[ht!][scale=0.2]{Graficaslvsnl/u6.png}
       {Respuesta temporal variable $x_3$ para entrada $u=6.0$\label{fig:u6}}

\Figure[ht!][scale=0.2]{Graficaslvsnl/u6dif.png}
       {Respuesta temporal variable $x_3$ para entrada $u=6.0$ con diferencia entre las respuestas\label{fig:u6dif}}

\Figure[h!][scale=0.2]{Graficaslvsnl/u-100.png}
       {Respuesta temporal variable $x_3$ para entrada $u=-100.0$\label{fig:u-100}}
       
\subsection{Variación condiciones iniciales}
La gráficas mostradas, Figuras \ref{fig:t0.01} y \ref{fig:t0.1}, son producidas con pequeñas variaciones para la condición inicial de $x_3$. La Figura \ref{fig:t0.01} corresponde a una variación de 0.01 en la condición inicial y entrada $u=0$. La Figura \ref{fig:t0.1} es obtenida con variación de 0.1 en la condición inicial y entrada $u=0.1$. Comparando las dos gráficas mencionadas anteriormente, se concluye que variaciones relativamente pequeñas en la condición inicial para $x_3$, produce un desplazamiento vertical en la respuesta temporal del modelo lineal, igual al cambio en la condición. Por otro lado, este cambio define el rango de variación inicial en la respuesta temporal para el modelo no lineal. Esto se observa en ambas gráficas. Cuando $u=0$, la gráfica correspondiente al modelo lineal es una línea recta. Por último, cuando se varía $u$ en pequeñas cantidades, se presenta oscilamiento en la respuesta temporal para $x_3$ del modelo lineal.

\Figure[ht!][scale=0.2]{Graficaslvsnl/t0_01.png}
       {Respuesta temporal variable $x_3$ para entrada $u=0$ y condicional inicial $x_{30}=0.01$\label{fig:t0.01}}
       
 \Figure[ht!][scale=0.2]{Graficaslvsnl/t0_1.png}
       {Respuesta temporal variable para entrada $u=0.1$ y condicional inicial $x_{30}=0.1$\label{fig:t0.1}}

\newpage
\section{Referencias}
\bibliography{ref}
\bibliographystyle{alpha}

\begin{appendices}

\Figure[t!][scale=0.17]{figures/diff-inp/cos/cos.png}
       {Respuesta temporal del modelo, ante una entrada
        cosenoidal\label{fig:cos}}
\Figure[t!][scale=0.17]{figures/diff-inp/sin/sin.png}
       {Respuesta temporal del modelo, ante una señal
       sinusoidal\label{fig:sin}}
\Figure[t!][scale=0.17]{figures/diff-inp/rep/rep.png}
       {Respuesta temporal del modelo, ante una señal
       tipo sierra\label{fig:rep}}
\Figure[!t][scale=0.17]{figures/diff-inp/step/step.png}
       {Respuesta al impulso (retardado) modelo\label{fig:rep}}
\Figure[h!][scale=0.3]{figures/nm/th}
       {Comparacion de la respuesta temporal para la variable $\theta$,
         utilizando diferetes metodos numericos.\label{fig:nmth}}
\Figure[t!][scale=0.2]{figures/var/L/L.png}
	   {Respuesta temporal del modelo, ante cambios en el parametro \texttt{L}, la longitud del pendulo\label{fig:var-len}}
\Figure[t!][scale=0.2]{figures/var/m/m.png}{Respuesta temporal del modelo, ante cambios en el parametro
         \texttt{m}, la masa del pendulo.\label{fig:var-mass}}
\end{appendices}


\EOD{}\end{document}